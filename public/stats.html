<!DOCTYPE html>
<html>
<head>
    <title>~ Results ~</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="stats-container">
        <h2>~ Results ~</h2>
        <table border="0">
          <thead>
            <tr>
              <th>Player</th>
              <th>Survival Time</th>
              <th>Total Score</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
        <button onclick="window.location.href='game.html'">START NEW RUN</button>
    </div>

    <script>
    const rows = document.getElementById('rows');
    let data = JSON.parse(localStorage.getItem('leaderboard') || '[]');

    // --- Audio Setup ---
    const music = new Audio('music2.mp3');
    music.loop = true;
    music.volume = 0.4;

    // Function to try and play music
    function playMusic() {
        music.play().catch(() => {
            // If auto-play is blocked, wait for a click
            console.log("Autoplay blocked. Waiting for user interaction...");
            document.addEventListener('click', () => {
                music.play();
            }, { once: true });
        });
    }

    // --- Table Logic ---
    data.sort((a, b) => b.score - a.score);

    function renderTable() {
        rows.innerHTML = ''; 
        data.forEach((entry, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td style="color:#ffd700; font-weight:bold;">${entry.name}</td>
                <td>${entry.time}s</td>
                <td>${entry.score}</td>
                <td style="font-size: 12px; color: #888;">${entry.date}</td>
                <td>
                    <button onclick="deleteEntry(${index})" style="padding: 5px 10px; font-size: 12px; background: #ff4444; color: white; border:none; cursor:pointer;">
                        Delete
                    </button>
                </td>
            `;
            rows.appendChild(tr);
        });
    }

    window.deleteEntry = function(index) {
        if (confirm("Are you sure you want to delete this score?")) {
            data.splice(index, 1);
            localStorage.setItem('leaderboard', JSON.stringify(data));
            renderTable();
        }
    };

    // Initialize
    playMusic();
    renderTable();
    </script>
</body>
</html>